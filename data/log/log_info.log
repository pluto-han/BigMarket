25-11-24.13:19:13.516 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 30380 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:19:13.518 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:19:14.798 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:19:14.801 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:19:14.838 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
25-11-24.13:19:15.559 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:19:15.567 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:19:15.568 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:19:15.568 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:19:15.673 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:19:15.673 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2099 ms
25-11-24.13:19:16.991 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:19:20.217 [main            ] WARN  AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'IRaffleStrategyController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyArmoryAndDispatch': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
25-11-24.13:19:20.222 [main            ] INFO  StandardService        - Stopping service [Tomcat]
25-11-24.13:19:20.239 [main            ] INFO  ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
25-11-24.13:19:20.271 [main            ] ERROR SpringApplication      - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'IRaffleStrategyController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyArmoryAndDispatch': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:332)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1303)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1292)
	at org.example.Application.main(Application.java:16)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyArmoryAndDispatch': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:332)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:544)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	... 17 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:332)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:544)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	... 33 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:332)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:544)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	... 49 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'redissonClient' defined in class path resource [org/example/config/RedisClientConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:658)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:213)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeanByName(AbstractAutowireCapableBeanFactory.java:479)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:550)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	... 65 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.redisson.api.RedissonClient]: Factory method 'redissonClient' threw exception; nested exception is org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	... 81 common frames omitted
Caused by: org.redisson.client.RedisConnectionException: Unable to connect to Redis server: 127.0.0.1/127.0.0.1:16379
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$0(ConnectionPool.java:132)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.redisson.connection.pool.ConnectionPool.promiseFailure(ConnectionPool.java:294)
	at org.redisson.connection.pool.ConnectionPool.lambda$createConnection$6(ConnectionPool.java:253)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.redisson.client.RedisClient$1$2.run(RedisClient.java:257)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.CompletionException: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: 127.0.0.1/127.0.0.1:16379
	at java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:326)
	at java.util.concurrent.CompletableFuture.completeRelay(CompletableFuture.java:338)
	at java.util.concurrent.CompletableFuture.uniRelay(CompletableFuture.java:925)
	at java.util.concurrent.CompletableFuture$UniRelay.tryFire(CompletableFuture.java:913)
	... 12 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: 127.0.0.1/127.0.0.1:16379
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.13:19:55.241 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 31051 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:19:55.244 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:19:56.235 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:19:56.238 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:19:56.270 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-24.13:19:56.964 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:19:56.971 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:19:56.972 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:19:56.972 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:19:57.035 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:19:57.035 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1750 ms
25-11-24.13:19:58.040 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:19:58.334 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:19:58.352 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:20:00.001 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:20:00.120 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:20:00.122 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:20:00.149 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#38ac8968:0/SimpleConnection@75f4d8a8 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 60204]
25-11-24.13:20:00.210 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"64174857148","timestamp":1763926411851}
25-11-24.13:20:00.222 [main            ] INFO  Application            - Started Application in 5.466 seconds (JVM running for 5.995)
25-11-24.13:20:00.232 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:20:00.233 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:20:01.203 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:20:01.212 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:20:01.234 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:20:01.235 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:24:58.815 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 32145 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:24:58.818 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:24:59.878 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:24:59.880 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:24:59.921 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
25-11-24.13:25:00.707 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:25:00.715 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:25:00.716 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:25:00.716 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:25:00.784 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:25:00.784 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1910 ms
25-11-24.13:25:01.661 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:25:01.877 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:25:01.899 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:25:04.117 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:25:04.213 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.13:25:04.234 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:25:04.236 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:25:04.274 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#418f0534:0/SimpleConnection@6550ce46 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 36148]
25-11-24.13:25:04.345 [main            ] INFO  Application            - Started Application in 6.242 seconds (JVM running for 7.112)
25-11-24.13:25:04.713 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:25:04.714 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.13:25:04.714 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.13:25:04.716 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.13:25:05.045 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:25:05.058 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:25:05.082 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:25:05.161 [pool-3-thread-3 ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"94880903890","timestamp":1763926412371}
25-11-24.13:25:05.183 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"94880903890","timestamp":1763926412371}
25-11-24.13:27:07.018 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:27:07.019 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:27:08.002 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:27:08.002 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:27:08.029 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:27:08.030 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:27:11.160 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 32826 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:27:11.164 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:27:12.137 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:27:12.139 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:27:12.167 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.13:27:12.856 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:27:12.862 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:27:12.863 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:27:12.863 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:27:12.920 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:27:12.920 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1583 ms
25-11-24.13:27:13.597 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:27:13.768 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:27:13.779 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:27:15.176 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:27:15.271 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.13:27:15.292 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:27:15.294 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:27:15.323 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 59284]
25-11-24.13:27:15.379 [main            ] INFO  Application            - Started Application in 4.763 seconds (JVM running for 5.418)
25-11-24.13:27:15.771 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.13:27:15.771 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.13:27:15.772 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:27:15.773 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.13:27:15.967 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:27:15.983 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:27:16.002 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:30:39.005 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动装配，数据预热开始 activityId:100301
25-11-24.13:30:39.011 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:30:39.040 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:30:39.146 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动装配，数据预热完成 activityId:100301
25-11-24.13:34:06.479 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:34:06.480 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:34:07.141 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:34:07.412 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:34:07.433 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:34:07.434 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:34:11.138 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 34373 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:34:11.141 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:34:11.968 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:34:11.970 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:34:11.994 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.13:34:12.628 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:34:12.634 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:34:12.635 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:34:12.635 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:34:12.689 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:34:12.690 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1506 ms
25-11-24.13:34:13.345 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:34:13.512 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:34:13.524 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:34:14.889 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:34:14.974 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.13:34:14.997 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:34:14.999 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:34:15.029 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 45014]
25-11-24.13:34:15.111 [main            ] INFO  Application            - Started Application in 4.458 seconds (JVM running for 5.012)
25-11-24.13:34:15.360 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.13:34:15.360 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.13:34:15.361 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:34:15.362 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.13:34:15.557 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:34:15.575 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:34:15.595 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:34:20.318 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:null activityId:null
25-11-24.13:34:20.322 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:null activityId:null code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:78)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.13:35:08.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:35:08.112 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:35:08.300 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:35:08.454 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:35:08.520 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:35:08.521 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:35:12.010 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 34861 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:35:12.013 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:35:12.928 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:35:12.930 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:35:12.957 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
25-11-24.13:35:13.818 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:35:13.832 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:35:13.833 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:35:13.834 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:35:13.914 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:35:13.914 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1818 ms
25-11-24.13:35:15.260 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:35:15.989 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:35:16.030 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:35:18.038 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:35:18.128 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.13:35:18.148 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:35:18.151 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:35:18.180 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5ed0b4e3:0/SimpleConnection@6282f1eb [delegate=amqp://admin@127.0.0.1:5672/, localPort= 44582]
25-11-24.13:35:18.249 [main            ] INFO  Application            - Started Application in 6.786 seconds (JVM running for 7.376)
25-11-24.13:35:18.696 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:35:18.696 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.13:35:18.696 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.13:35:18.698 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.13:35:18.902 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:35:18.922 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:35:18.938 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:35:25.292 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:35:25.332 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:35:25.333 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:35:25.346 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.13:35:25.347 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.13:35:25.347 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:35:25.362 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:35:25.394 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.13:36:10.334 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:36:17.429 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:36:17.429 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:36:25.365 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.13:36:25.365 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.13:36:25.383 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.13:36:25.413 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:36:25.414 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.13:38:07.054 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m1s556ms4µs694ns).
25-11-24.13:38:07.054 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m51s270ms983µs282ns).
25-11-24.13:38:07.052 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m1s555ms918µs12ns).
25-11-24.13:38:07.067 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:38:07.074 [http-nio-8091-exec-5] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:38:07.074 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:38:54.748 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=50s38ms656µs989ns).
25-11-24.13:38:54.748 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=50s38ms680µs504ns).
25-11-24.13:38:54.748 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=50s38ms801µs461ns).
25-11-24.13:38:54.750 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.13:38:54.758 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.13:39:30.880 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.13:42:07.599 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m48s671ms205µs891ns).
25-11-24.13:42:07.599 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m48s671ms253µs820ns).
25-11-24.13:42:07.599 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m48s671ms492µs508ns).
25-11-24.13:42:50.738 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=48s128ms649µs246ns).
25-11-24.13:42:50.738 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=48s129ms131µs623ns).
25-11-24.13:42:50.738 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=48s128ms925µs276ns).
25-11-24.13:43:32.837 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.13:43:32.840 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SimpleMessageListenerContainer - Restarting Consumer@77a9ac36: tags=[[amq.ctag-JsH60AbKllCT4oz1yhUKwQ]], channel=Cached Rabbit Channel: AMQChannel(amqp://admin@127.0.0.1:5672/,2), conn: Proxy@1dfcf85a Shared Rabbit Connection: SimpleConnection@6282f1eb [delegate=amqp://admin@127.0.0.1:5672/, localPort= 44582], acknowledgeMode=AUTO local queue size=0
25-11-24.13:43:32.840 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  SimpleMessageListenerContainer - Restarting Consumer@3a48c398: tags=[[amq.ctag-doyXw3ivDTuV2wWh0DDK-Q]], channel=Cached Rabbit Channel: AMQChannel(amqp://admin@127.0.0.1:5672/,1), conn: Proxy@1dfcf85a Shared Rabbit Connection: SimpleConnection@6282f1eb [delegate=amqp://admin@127.0.0.1:5672/, localPort= 44582], acknowledgeMode=AUTO local queue size=0
25-11-24.13:43:32.851 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:43:32.851 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.13:44:10.864 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:44:10.864 [redisson-timer-4-1] ERROR PingConnectionHandler  - Unable to send PING command over channel: [id: 0xfaca1f83, L:/127.0.0.1:55054 - R:127.0.0.1/127.0.0.1:16379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://127.0.0.1:16379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.13:44:10.870 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:44:10.871 [redisson-timer-4-1] ERROR PingConnectionHandler  - Unable to send PING command over channel: [id: 0x7057c1f5, L:/127.0.0.1:55076 - R:127.0.0.1/127.0.0.1:16379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://127.0.0.1:16379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.13:44:10.875 [redisson-timer-4-1] ERROR PingConnectionHandler  - Unable to send PING command over channel: [id: 0xfc9bcc95, L:/127.0.0.1:55084 - R:127.0.0.1/127.0.0.1:16379]
org.redisson.client.RedisTimeoutException: Command execution timeout for command: (PING), params: [], Redis client: [addr=redis://127.0.0.1:16379]
	at org.redisson.client.RedisConnection.lambda$async$0(RedisConnection.java:256)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.13:44:10.880 [http-nio-8091-exec-6] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:44:10.880 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:44:11.745 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5ed0b4e3:1/SimpleConnection@17e65a1a [delegate=amqp://admin@127.0.0.1:5672/, localPort= 59310]
25-11-24.13:44:13.569 [http-nio-8091-exec-5] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 104
25-11-24.13:44:13.569 [http-nio-8091-exec-3] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 103
25-11-24.13:44:13.592 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$ad97da56.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:44:13.592 [http-nio-8091-exec-5] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$ad97da56.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:44:14.416 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.13:44:14.416 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.13:44:23.219 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.13:50:36.154 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=6m59s166ms238µs412ns).
25-11-24.13:50:36.155 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=6m59s166ms310µs90ns).
25-11-24.13:51:25.131 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=6m59s176ms355µs181ns).
25-11-24.13:51:29.928 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Restarting Consumer@78d04b31: tags=[[amq.ctag-0vrwbnEL2ip0uq5H4SZ6LQ]], channel=Cached Rabbit Channel: AMQChannel(amqp://admin@127.0.0.1:5672/,2), conn: Proxy@1dfcf85a Shared Rabbit Connection: SimpleConnection@17e65a1a [delegate=amqp://admin@127.0.0.1:5672/, localPort= 59310], acknowledgeMode=AUTO local queue size=0
25-11-24.13:51:29.928 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Restarting Consumer@598c434a: tags=[[amq.ctag-JTVhtTMT78vBvIa8NQzPdA]], channel=Cached Rabbit Channel: AMQChannel(amqp://admin@127.0.0.1:5672/,1), conn: Proxy@1dfcf85a Shared Rabbit Connection: SimpleConnection@17e65a1a [delegate=amqp://admin@127.0.0.1:5672/, localPort= 59310], acknowledgeMode=AUTO local queue size=0
25-11-24.13:51:50.229 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.13:51:50.234 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:51:50.248 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5ed0b4e3:2/SimpleConnection@624d5c38 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 38884]
25-11-24.13:51:50.248 [scheduling-1    ] ERROR UpdateActivitySkuStockJob - 定时任务，更新活动sku库存失败
org.springframework.dao.QueryTimeoutException: Redis server response timeout (3000 ms) occured after 0 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0xb5108986, L:/127.0.0.1:47682 - R:127.0.0.1/127.0.0.1:16379]; nested exception is org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (3000 ms) occured after 0 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0xb5108986, L:/127.0.0.1:47682 - R:127.0.0.1/127.0.0.1:16379]
	at org.redisson.spring.data.connection.RedissonExceptionConverter.convert(RedissonExceptionConverter.java:48)
	at org.redisson.spring.data.connection.RedissonExceptionConverter.convert(RedissonExceptionConverter.java:35)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.redisson.spring.data.connection.RedissonConnectionFactory.translateExceptionIfPossible(RedissonConnectionFactory.java:91)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$3e217b28.takeQueueValue(<generated>)
	at org.example.domain.activity.service.quota.RaffleActivityAccountQuotaService.takeQueueValue(RaffleActivityAccountQuotaService.java:70)
	at org.example.trigger.job.UpdateActivitySkuStockJob.exec(UpdateActivitySkuStockJob.java:27)
	at sun.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (3000 ms) occured after 0 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0xb5108986, L:/127.0.0.1:47682 - R:127.0.0.1/127.0.0.1:16379]
	at org.redisson.command.RedisExecutor.lambda$scheduleResponseTimeout$9(RedisExecutor.java:407)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
25-11-24.13:51:52.750 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m21s448ms538µs272ns).
25-11-24.13:51:52.753 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m21s451ms476µs843ns).
25-11-24.13:51:52.760 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m21s448ms544µs392ns).
25-11-24.13:54:17.871 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:54:17.877 [http-nio-8091-exec-10] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:54:17.877 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:54:25.712 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.13:54:25.712 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.13:54:30.624 [http-nio-8091-exec-10] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.13:54:33.166 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:54:33.172 [http-nio-8091-exec-9] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:54:33.172 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:54:33.177 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.13:54:33.177 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.13:54:33.182 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.13:54:33.186 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:54:33.186 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.13:54:33.200 [http-nio-8091-exec-9] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 103
25-11-24.13:54:33.206 [http-nio-8091-exec-9] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$ad97da56.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:54:34.734 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:54:34.749 [http-nio-8091-exec-11] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:54:34.750 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:54:34.753 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.13:54:34.753 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.13:54:34.758 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.13:54:35.757 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:54:35.764 [http-nio-8091-exec-12] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:54:35.764 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:54:35.769 [http-nio-8091-exec-12] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.13:54:35.769 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.13:54:35.776 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.13:54:35.779 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:54:35.780 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.13:54:35.790 [http-nio-8091-exec-12] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 102
25-11-24.13:54:35.798 [http-nio-8091-exec-12] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$ad97da56.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:54:40.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.13:54:42.613 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.13:54:52.087 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:54:52.092 [http-nio-8091-exec-13] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:54:52.092 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:54:52.097 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.13:54:52.097 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.13:54:52.102 [http-nio-8091-exec-13] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.13:54:59.377 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:54:59.378 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-4] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.13:55:00.240 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-4] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:55:00.243 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.13:55:00.286 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:55:00.287 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.13:55:06.517 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 38733 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.13:55:06.519 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.13:55:07.282 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.13:55:07.284 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.13:55:07.331 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 28 ms. Found 0 Redis repository interfaces.
25-11-24.13:55:07.852 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.13:55:07.857 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.13:55:07.858 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.13:55:07.858 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.13:55:07.910 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.13:55:07.910 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1355 ms
25-11-24.13:55:08.539 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.13:55:08.710 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:55:08.728 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.13:55:07.844 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.13:55:07.961 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.13:55:07.981 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.13:55:07.983 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.13:55:08.012 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#437ed416:0/SimpleConnection@797f97e3 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 45040]
25-11-24.13:55:08.076 [main            ] INFO  Application            - Started Application in 4.383 seconds (JVM running for 4.854)
25-11-24.13:55:08.518 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.13:55:08.518 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:55:08.519 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.13:55:08.520 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.13:55:08.734 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:55:08.756 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:55:08.771 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:55:13.121 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:55:13.146 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:55:13.146 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:55:13.157 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.13:55:13.157 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.13:55:13.158 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.13:55:13.172 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.13:55:13.183 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.13:55:13.206 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:55:13.206 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.13:55:13.353 [http-nio-8091-exec-1] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 102
25-11-24.13:55:13.363 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$cf798ec3.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:55:20.005 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.13:56:05.548 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.13:56:05.554 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.13:56:05.554 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.13:56:05.559 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.13:56:05.559 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.13:56:05.564 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.13:56:05.568 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.13:56:05.568 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.13:56:05.574 [http-nio-8091-exec-3] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 102
25-11-24.13:56:05.578 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$cf798ec3.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.13:56:10.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.14:18:44.716 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:18:44.809 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:207200090260
25-11-24.14:18:44.819 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.14:18:44.820 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.14:18:44.829 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.14:18:44.838 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:18:44.838 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.14:18:44.884 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"00815100412","timestamp":1763990324840}
25-11-24.14:18:44.942 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"00815100412","timestamp":1763990324840}
25-11-24.14:18:49.357 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:18:49.428 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:164705352053
25-11-24.14:18:49.435 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.14:18:49.436 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.14:18:49.444 [http-nio-8091-exec-7] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.14:18:50.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.14:18:50.432 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:18:50.442 [http-nio-8091-exec-8] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:18:50.442 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:164705352053
25-11-24.14:18:50.447 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.14:18:50.447 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.14:18:50.455 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.14:18:50.458 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:18:50.458 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.14:18:50.487 [http-nio-8091-exec-8] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"14940731790","timestamp":1763990330461}
25-11-24.14:18:50.490 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"14940731790","timestamp":1763990330461}
25-11-24.14:18:51.694 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:18:51.724 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:239518809638
25-11-24.14:18:51.727 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.14:18:51.727 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.14:18:51.731 [http-nio-8091-exec-10] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.14:18:55.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.14:19:03.090 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:19:03.098 [http-nio-8091-exec-9] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:19:03.098 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:239518809638
25-11-24.14:19:03.104 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.14:19:03.104 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.14:19:03.109 [http-nio-8091-exec-9] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.14:19:17.981 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:19:17.988 [http-nio-8091-exec-11] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:19:17.989 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:239518809638
25-11-24.14:19:17.994 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.14:19:17.994 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.14:19:18.000 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.14:19:18.003 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:19:18.003 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.14:19:18.026 [http-nio-8091-exec-11] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"73936987263","timestamp":1763990358005}
25-11-24.14:19:18.029 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"73936987263","timestamp":1763990358005}
25-11-24.14:19:25.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.14:19:25.111 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:19:25.139 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:689690082235
25-11-24.14:19:25.143 [http-nio-8091-exec-12] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.14:19:25.143 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.14:19:25.146 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.14:19:25.148 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:19:25.148 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.14:19:25.180 [http-nio-8091-exec-12] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"89342372479","timestamp":1763990365163}
25-11-24.14:19:25.181 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"89342372479","timestamp":1763990365163}
25-11-24.14:19:29.230 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:19:29.258 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:065997365339
25-11-24.14:19:29.261 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.14:19:29.262 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.14:19:29.267 [http-nio-8091-exec-13] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.14:19:27.482 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.14:36:21.662 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:36:21.677 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:36:21.914 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:36:22.387 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:36:22.512 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:36:22.514 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:36:25.671 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 46676 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.14:36:25.674 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.14:36:26.831 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.14:36:26.833 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.14:36:26.866 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
25-11-24.14:36:27.895 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.14:36:27.902 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.14:36:27.903 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.14:36:27.904 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.14:36:27.963 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.14:36:27.963 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2226 ms
25-11-24.14:36:28.794 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.14:36:29.036 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:36:29.050 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:36:30.861 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.14:36:30.968 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.14:36:30.997 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.14:36:31.000 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.14:36:31.051 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 33884]
25-11-24.14:36:31.138 [main            ] INFO  Application            - Started Application in 6.013 seconds (JVM running for 6.719)
25-11-24.14:36:31.362 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:36:31.362 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.14:36:31.363 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.14:36:31.366 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.14:36:31.664 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:36:31.693 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:36:31.714 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:36:37.708 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:36:37.753 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:36:37.753 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:065997365339
25-11-24.14:36:37.770 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.14:36:37.770 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.14:36:37.771 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:36:37.793 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:36:37.810 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.14:36:37.856 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:36:37.856 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.14:36:38.118 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"45673156464","timestamp":1763991397868}
25-11-24.14:36:38.130 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"45673156464","timestamp":1763991397868}
25-11-24.14:36:43.524 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:36:58.874 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.14:37:14.860 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=45s623ms802µs654ns).
25-11-24.14:37:14.861 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=45s574ms848µs468ns).
25-11-24.14:37:17.674 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:793429547587
25-11-24.14:37:17.679 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.14:37:17.679 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.14:37:17.684 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.14:37:17.688 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:17.688 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.14:37:17.710 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"07822249612","timestamp":1763991437697}
25-11-24.14:37:17.712 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"07822249612","timestamp":1763991437697}
25-11-24.14:37:20.782 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:20.810 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:283443351561
25-11-24.14:37:20.816 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.14:37:20.816 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.14:37:20.821 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.14:37:20.824 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:20.824 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.14:37:20.840 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"30130116751","timestamp":1763991440826}
25-11-24.14:37:20.841 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"30130116751","timestamp":1763991440826}
25-11-24.14:37:21.742 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:21.770 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:320948349545
25-11-24.14:37:21.776 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.14:37:21.776 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.14:37:21.781 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.14:37:21.784 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:21.784 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.14:37:21.800 [http-nio-8091-exec-5] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"10803348072","timestamp":1763991441786}
25-11-24.14:37:21.801 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"10803348072","timestamp":1763991441786}
25-11-24.14:37:22.537 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.14:37:22.708 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:22.734 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:826562598667
25-11-24.14:37:22.738 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.14:37:22.738 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.14:37:22.743 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.14:37:22.746 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:22.746 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.14:37:22.764 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"95393706022","timestamp":1763991442747}
25-11-24.14:37:22.766 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"95393706022","timestamp":1763991442747}
25-11-24.14:37:23.610 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:23.638 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:998799069767
25-11-24.14:37:23.642 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.14:37:23.642 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.14:37:23.645 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.14:37:23.649 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:23.649 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.14:37:23.670 [http-nio-8091-exec-7] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"82032605113","timestamp":1763991443650}
25-11-24.14:37:23.671 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":105,"awardTitle":"4等奖","userId":"xiaofuge"},"id":"82032605113","timestamp":1763991443650}
25-11-24.14:37:24.677 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:24.710 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:389581776109
25-11-24.14:37:24.714 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.14:37:24.714 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.14:37:24.717 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.14:37:24.720 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:24.720 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.14:37:24.743 [http-nio-8091-exec-8] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"08923636041","timestamp":1763991444721}
25-11-24.14:37:24.744 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"08923636041","timestamp":1763991444721}
25-11-24.14:37:25.784 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:25.822 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:777191678096
25-11-24.14:37:25.827 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.14:37:25.827 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.14:37:25.831 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.14:37:25.834 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:37:25.834 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.14:37:25.849 [http-nio-8091-exec-9] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"92284527119","timestamp":1763991445835}
25-11-24.14:37:25.850 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"92284527119","timestamp":1763991445835}
25-11-24.14:37:27.135 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:27.157 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:765507498555
25-11-24.14:37:27.161 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.14:37:27.161 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.14:37:27.165 [http-nio-8091-exec-10] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.14:37:30.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.14:37:35.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.14:37:38.590 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:37:38.594 [http-nio-8091-exec-11] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:37:38.594 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:765507498555
25-11-24.14:37:38.598 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.14:37:38.598 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.14:37:38.602 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.14:37:40.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.14:37:45.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.14:37:45.714 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:37:45.715 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:37:45.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:37:46.218 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:37:46.276 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:37:46.277 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:37:51.128 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 47280 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.14:37:51.130 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.14:37:51.999 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.14:37:52.001 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.14:37:52.026 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
25-11-24.14:37:52.783 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.14:37:52.791 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.14:37:52.792 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.14:37:52.792 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.14:37:52.878 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.14:37:52.878 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1705 ms
25-11-24.14:37:53.768 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.14:37:53.954 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:37:53.963 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:37:54.843 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.14:37:55.019 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.14:37:55.032 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.14:37:55.034 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.14:37:55.063 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#437ed416:0/SimpleConnection@797f97e3 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 59416]
25-11-24.14:37:55.118 [main            ] INFO  Application            - Started Application in 4.36 seconds (JVM running for 4.83)
25-11-24.14:37:55.639 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.14:37:55.639 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.14:37:55.640 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:37:55.641 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.14:37:55.807 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:37:55.822 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:37:55.840 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:38:00.029 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.14:38:00.044 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:38:00.062 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:38:05.011 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.14:38:25.572 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:38:25.595 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:38:25.595 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:765507498555
25-11-24.14:38:25.605 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.14:38:25.605 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.14:38:25.618 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.14:38:25.639 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:38:25.639 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.14:38:25.763 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"58311820450","timestamp":1763991505644}
25-11-24.14:38:25.771 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"58311820450","timestamp":1763991505644}
25-11-24.14:38:27.054 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:38:27.112 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:845516519543
25-11-24.14:38:27.119 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.14:38:27.119 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.14:38:27.125 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.14:38:27.130 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:38:27.130 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.14:38:27.151 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"52522470242","timestamp":1763991507132}
25-11-24.14:38:27.153 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"52522470242","timestamp":1763991507132}
25-11-24.14:38:30.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.14:38:35.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.14:38:43.626 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:38:43.656 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:852830834932
25-11-24.14:38:43.660 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.14:38:43.660 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.14:38:43.663 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.14:38:43.666 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:38:43.666 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.14:38:43.679 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"85036745573","timestamp":1763991523667}
25-11-24.14:38:43.681 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"85036745573","timestamp":1763991523667}
25-11-24.14:38:48.299 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:38:48.323 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:617965772412
25-11-24.14:38:48.326 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.14:38:48.326 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.14:38:48.330 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.14:38:48.332 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:38:48.333 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.14:38:48.353 [http-nio-8091-exec-5] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"17405095189","timestamp":1763991528334}
25-11-24.14:38:48.354 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"17405095189","timestamp":1763991528334}
25-11-24.14:38:50.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.14:38:50.058 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:38:50.085 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:730171426960
25-11-24.14:38:50.089 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.14:38:50.090 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.14:38:50.093 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.14:38:55.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.14:43:41.186 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:43:41.191 [http-nio-8091-exec-9] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:43:41.191 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:730171426960
25-11-24.14:43:41.195 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.14:43:41.195 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.14:43:41.199 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.14:43:41.202 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:43:41.202 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.14:43:41.219 [http-nio-8091-exec-9] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"49001376188","timestamp":1763991821203}
25-11-24.14:43:41.222 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"49001376188","timestamp":1763991821203}
25-11-24.14:43:44.661 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:43:44.675 [http-nio-8091-exec-10] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.domain.activity.service.partake.RaffleActivityPartakeService.doFilterAccount(RaffleActivityPartakeService.java:39)
	at org.example.domain.activity.service.partake.AbstractRaffleActivityPartake.createRaffleOrder(AbstractRaffleActivityPartake.java:64)
	at org.example.domain.activity.service.partake.AbstractRaffleActivityPartake.createRaffleOrder(AbstractRaffleActivityPartake.java:32)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:82)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
25-11-24.14:43:45.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.14:44:49.146 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:44:49.181 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:941496967766
25-11-24.14:44:49.185 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.14:44:49.185 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.14:44:49.188 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.14:44:49.191 [http-nio-8091-exec-13] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:44:49.191 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.14:44:49.205 [http-nio-8091-exec-13] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"78378913217","timestamp":1763991889192}
25-11-24.14:44:49.206 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"78378913217","timestamp":1763991889192}
25-11-24.14:44:52.835 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:44:52.882 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:372933576988
25-11-24.14:44:52.887 [http-nio-8091-exec-14] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.14:44:52.887 [http-nio-8091-exec-14] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.14:44:52.892 [http-nio-8091-exec-14] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.14:44:55.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.14:53:14.961 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:53:14.960 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.14:53:15.004 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:53:15.345 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.14:53:15.454 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:53:15.458 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.14:53:22.539 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 50464 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.14:53:22.542 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.14:53:23.519 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.14:53:23.521 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.14:53:23.557 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 21 ms. Found 0 Redis repository interfaces.
25-11-24.14:53:24.186 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.14:53:24.192 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.14:53:24.193 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.14:53:24.193 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.14:53:24.251 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.14:53:24.251 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1657 ms
25-11-24.14:53:24.846 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.14:53:24.998 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:53:25.010 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.14:53:26.329 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.14:53:26.420 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.14:53:26.438 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.14:53:26.440 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.14:53:26.474 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#437ed416:0/SimpleConnection@797f97e3 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 56560]
25-11-24.14:53:26.543 [main            ] INFO  Application            - Started Application in 4.437 seconds (JVM running for 4.992)
25-11-24.14:53:26.884 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:53:26.884 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.14:53:26.885 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.14:53:26.886 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.14:53:27.127 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:53:27.145 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:53:27.163 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:53:35.306 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:53:35.331 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.14:53:35.331 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:372933576988
25-11-24.14:53:35.340 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.14:53:35.341 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.14:53:35.342 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.14:53:35.356 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.14:53:35.370 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.14:53:35.395 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:53:35.396 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.14:53:35.528 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"31251141008","timestamp":1763992415403}
25-11-24.14:53:35.539 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"31251141008","timestamp":1763992415403}
25-11-24.14:53:40.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.14:54:06.492 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:54:06.525 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:033884430342
25-11-24.14:54:06.530 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.14:54:06.530 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.14:54:06.534 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.14:54:06.537 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.14:54:06.537 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.14:54:06.563 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"34332894979","timestamp":1763992446539}
25-11-24.14:54:06.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"34332894979","timestamp":1763992446539}
25-11-24.14:54:10.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.14:54:12.078 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.14:54:12.104 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:508639746333
25-11-24.14:54:12.109 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.14:54:12.109 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.14:54:12.113 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.15:20:58.143 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:20:58.145 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:20:58.455 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:20:58.847 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:20:58.939 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:20:58.941 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:21:05.999 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 55784 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:21:06.002 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:21:07.621 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:21:07.626 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:21:07.693 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 35 ms. Found 0 Redis repository interfaces.
25-11-24.15:21:08.708 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:21:08.716 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:21:08.716 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:21:08.717 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:21:08.803 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:21:08.803 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2742 ms
25-11-24.15:21:09.954 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:21:10.237 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:21:10.272 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:21:12.517 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:21:12.629 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:21:12.661 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:21:12.663 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:21:12.699 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1a1c21b4:0/SimpleConnection@53e28097 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 34830]
25-11-24.15:21:12.773 [main            ] INFO  Application            - Started Application in 7.282 seconds (JVM running for 7.965)
25-11-24.15:21:13.126 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:21:13.126 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:21:13.126 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:21:13.128 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.15:21:13.336 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:21:13.362 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:21:13.382 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:21:18.400 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:21:18.447 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:21:18.447 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:508639746333
25-11-24.15:21:18.467 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.15:21:18.468 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.15:21:18.469 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:21:18.492 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:21:18.521 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.15:22:14.492 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:22:14.494 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:22:15.004 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:22:15.019 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:22:15.055 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:22:15.056 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:22:18.926 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 56329 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:22:18.929 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:22:19.989 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:22:19.991 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:22:20.016 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
25-11-24.15:22:20.710 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:22:20.717 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:22:20.717 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:22:20.717 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:22:20.782 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:22:20.782 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1765 ms
25-11-24.15:22:21.405 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:22:21.539 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:22:21.554 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:22:22.714 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:22:22.799 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:22:22.825 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:22:22.827 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:22:22.858 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#14de1901:0/SimpleConnection@102af1bb [delegate=amqp://admin@127.0.0.1:5672/, localPort= 40520]
25-11-24.15:22:22.952 [main            ] INFO  Application            - Started Application in 4.567 seconds (JVM running for 5.391)
25-11-24.15:22:23.466 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:22:23.466 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:22:23.467 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:22:23.468 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.15:22:23.664 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:22:23.681 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:22:23.702 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:22:26.665 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:26.690 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:22:26.690 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:508639746333
25-11-24.15:22:26.700 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.15:22:26.700 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.15:22:26.701 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:22:26.713 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:22:26.725 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.15:22:26.748 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:22:26.749 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.15:22:26.923 [http-nio-8091-exec-1] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"65698914988","timestamp":1763994146756}
25-11-24.15:22:26.939 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"65698914988","timestamp":1763994146756}
25-11-24.15:22:30.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.15:22:32.857 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:32.894 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:901191959295
25-11-24.15:22:32.899 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.15:22:32.899 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.15:22:32.903 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.15:22:32.906 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:22:32.906 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.15:22:32.923 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"13693528638","timestamp":1763994152908}
25-11-24.15:22:32.924 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"13693528638","timestamp":1763994152908}
25-11-24.15:22:36.809 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:36.838 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:367210011160
25-11-24.15:22:36.845 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.15:22:36.846 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.15:22:36.850 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.15:22:36.854 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:22:36.854 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.15:22:36.867 [http-nio-8091-exec-5] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"67562561718","timestamp":1763994156855}
25-11-24.15:22:36.868 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"67562561718","timestamp":1763994156855}
25-11-24.15:22:40.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.15:22:38.735 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:38.769 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:239028290656
25-11-24.15:22:38.776 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.15:22:38.776 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.15:22:38.780 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.15:22:38.783 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:22:38.784 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.15:22:38.803 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"13423181184","timestamp":1763994158785}
25-11-24.15:22:38.805 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"13423181184","timestamp":1763994158785}
25-11-24.15:22:42.428 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.15:22:43.185 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:43.207 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:377964550531
25-11-24.15:22:43.211 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.15:22:43.211 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.15:22:43.214 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.15:22:43.217 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:22:43.217 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.15:22:43.232 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"69544104223","timestamp":1763994163218}
25-11-24.15:22:43.234 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"69544104223","timestamp":1763994163218}
25-11-24.15:22:44.277 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:22:44.298 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:460115666963
25-11-24.15:22:44.301 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.15:22:44.301 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.15:22:44.305 [http-nio-8091-exec-7] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.15:22:44.305 [http-nio-8091-exec-7] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:22:50.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.15:22:55.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.15:27:20.693 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:27:20.701 [http-nio-8091-exec-10] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:27:20.701 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:460115666963
25-11-24.15:27:20.706 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.15:27:20.706 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.15:27:20.713 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.15:27:20.716 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:27:20.717 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.15:27:20.734 [http-nio-8091-exec-10] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"48011561030","timestamp":1763994440718}
25-11-24.15:27:20.738 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"48011561030","timestamp":1763994440718}
25-11-24.15:27:22.379 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:27:22.408 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:675236443468
25-11-24.15:27:22.412 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.15:27:22.412 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.15:27:22.415 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.15:27:22.418 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:27:22.418 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.15:27:22.431 [http-nio-8091-exec-11] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"01381210836","timestamp":1763994442419}
25-11-24.15:27:22.432 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"01381210836","timestamp":1763994442419}
25-11-24.15:27:24.253 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:27:24.281 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:27:24.285 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.15:27:24.285 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.15:27:24.289 [http-nio-8091-exec-13] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.15:27:24.289 [http-nio-8091-exec-13] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:27:25.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.15:27:30.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.15:28:48.535 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:28:48.536 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:28:48.669 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:28:48.858 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:28:48.902 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:28:48.903 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:28:53.532 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 57894 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:28:53.534 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:28:54.396 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:28:54.398 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:28:54.428 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
25-11-24.15:28:55.263 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:28:55.277 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:28:55.277 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:28:55.278 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:28:55.372 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:28:55.373 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1796 ms
25-11-24.15:28:55.996 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:28:56.152 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:28:56.166 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:28:57.857 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:28:57.943 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:28:57.968 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:28:57.971 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:28:58.014 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1a1c21b4:0/SimpleConnection@53e28097 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 37514]
25-11-24.15:28:58.113 [main            ] INFO  Application            - Started Application in 4.984 seconds (JVM running for 5.459)
25-11-24.15:28:58.387 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:28:58.387 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:28:58.395 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:28:58.395 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 8 ms
25-11-24.15:28:58.695 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:28:58.711 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:28:58.731 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:29:02.786 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动装配，数据预热开始 activityId:100301
25-11-24.15:29:02.787 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:29:02.805 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:29:02.913 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动装配，数据预热完成 activityId:100301
25-11-24.15:29:21.831 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:29:21.853 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:29:21.853 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:29:21.858 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:29:21.859 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:29:21.879 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:29:21.879 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:29:27.485 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:29:27.489 [http-nio-8091-exec-4] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:29:27.490 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:29:27.493 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:29:27.493 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:29:27.501 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:29:27.502 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:29:28.280 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:29:28.287 [http-nio-8091-exec-5] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:29:28.287 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:29:28.290 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:29:28.291 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:29:28.295 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:29:28.295 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:29:28.921 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:29:28.929 [http-nio-8091-exec-6] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:29:28.929 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:29:28.933 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:29:28.933 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:29:28.937 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:29:28.938 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:29:44.055 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:29:44.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:29:44.961 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:29:45.025 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:29:45.045 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:29:45.046 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:29:47.320 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 58351 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:29:47.322 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:29:48.178 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:29:48.180 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:29:48.205 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-24.15:29:48.905 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:29:48.911 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:29:48.912 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:29:48.912 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:29:48.986 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:29:48.986 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1620 ms
25-11-24.15:29:50.264 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:29:50.794 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:29:50.820 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:29:52.508 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:29:52.615 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:29:52.637 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:29:52.640 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:29:52.674 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#133aacbe:0/SimpleConnection@13b29b34 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 36604]
25-11-24.15:29:52.755 [main            ] INFO  Application            - Started Application in 5.988 seconds (JVM running for 6.772)
25-11-24.15:29:52.874 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:29:52.874 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:29:52.875 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:29:52.877 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.15:29:53.177 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:29:53.221 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:29:53.255 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:30:03.875 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:30:03.902 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:30:03.902 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:30:03.912 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:30:03.913 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:30:03.914 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:30:03.929 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:30:03.943 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:30:07.141 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:30:28.935 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:30:28.940 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:30:28.940 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:30:28.946 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:30:28.946 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:30:28.952 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:30:31.099 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:31:38.540 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:31:38.542 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:31:39.264 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:31:39.277 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:31:39.309 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:31:39.309 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:31:41.275 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 59037 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:31:41.278 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:31:42.026 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:31:42.028 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:31:42.054 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-24.15:31:42.647 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:31:42.653 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:31:42.654 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:31:42.654 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:31:42.712 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:31:42.712 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1395 ms
25-11-24.15:31:43.349 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:31:43.512 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:31:43.525 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:31:44.761 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:31:44.843 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:31:44.860 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:31:44.863 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:31:44.891 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 37628]
25-11-24.15:31:44.946 [main            ] INFO  Application            - Started Application in 4.145 seconds (JVM running for 4.756)
25-11-24.15:31:45.032 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:31:45.032 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:31:45.221 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:31:45.221 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:31:45.463 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:31:45.464 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:31:45.467 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 3 ms
25-11-24.15:31:49.663 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:31:49.692 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:31:49.692 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:323362553171
25-11-24.15:31:49.703 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:31:49.704 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:31:49.704 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:31:49.721 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:31:49.732 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:31:53.806 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:32:23.757 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:32:23.758 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:11 userRaffleCount:11
25-11-24.15:32:23.759 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.15:32:23.762 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.15:32:23.807 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.15:32:23.807 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.15:32:23.953 [http-nio-8091-exec-1] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"35352060541","timestamp":1763994743820}
25-11-24.15:32:23.964 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"35352060541","timestamp":1763994743820}
25-11-24.15:32:30.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.15:32:30.310 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:32:30.311 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:32:30.770 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:32:30.974 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:32:31.082 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:32:31.084 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:32:34.820 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 59483 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:32:34.822 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:32:35.508 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:32:35.510 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:32:35.538 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
25-11-24.15:32:36.005 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:32:36.011 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:32:36.011 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:32:36.012 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:32:36.072 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:32:36.072 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1216 ms
25-11-24.15:32:36.599 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:32:36.727 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:32:36.737 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:32:37.851 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:32:37.918 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:32:37.929 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:32:37.931 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:32:37.948 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1cd2ff5b:0/SimpleConnection@6e794f53 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 32788]
25-11-24.15:32:37.990 [main            ] INFO  Application            - Started Application in 3.488 seconds (JVM running for 3.876)
25-11-24.15:32:38.316 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:32:38.316 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:32:38.316 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:32:38.318 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.15:32:38.458 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:32:38.471 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:32:38.486 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:32:44.041 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:32:44.099 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:068491079986
25-11-24.15:32:44.110 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:32:44.110 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:32:44.110 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:32:44.124 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:32:44.137 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:32:44.137 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:32:44.142 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:32:44.142 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:12 userRaffleCount:12
25-11-24.15:32:44.142 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.15:32:44.143 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.15:32:44.167 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.15:32:44.167 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.15:32:44.271 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"23464671258","timestamp":1763994764172}
25-11-24.15:32:44.279 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"23464671258","timestamp":1763994764172}
25-11-24.15:32:45.150 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:32:45.182 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:867094999909
25-11-24.15:32:45.187 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:32:45.188 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:32:45.193 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:32:45.193 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:32:45.198 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:32:45.198 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:13 userRaffleCount:13
25-11-24.15:32:45.198 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.15:32:45.198 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.15:32:45.203 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.15:32:45.203 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.15:32:45.220 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"27866491624","timestamp":1763994765205}
25-11-24.15:32:45.222 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"27866491624","timestamp":1763994765205}
25-11-24.15:32:46.434 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:32:46.459 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:909867582503
25-11-24.15:32:46.464 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:32:46.464 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:32:46.468 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:32:46.468 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:32:46.471 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:32:46.471 [http-nio-8091-exec-4] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:14 userRaffleCount:14
25-11-24.15:32:46.471 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.15:32:46.471 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.15:32:46.475 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.15:32:46.475 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.15:32:46.488 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"83462893497","timestamp":1763994766476}
25-11-24.15:32:46.489 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"83462893497","timestamp":1763994766476}
25-11-24.15:32:50.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.15:32:55.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.15:33:00.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.15:33:46.231 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:33:46.233 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.15:33:46.310 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:33:47.152 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.15:33:47.184 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:33:47.185 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.15:35:43.457 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 60354 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.15:35:43.459 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.15:35:44.193 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.15:35:44.195 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.15:35:44.229 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
25-11-24.15:35:44.710 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.15:35:44.714 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.15:35:44.715 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.15:35:44.715 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.15:35:44.762 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.15:35:44.762 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1260 ms
25-11-24.15:35:45.273 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.15:35:45.403 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:35:45.414 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.15:35:46.396 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.15:35:46.469 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.15:35:46.486 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.15:35:46.489 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.15:35:46.509 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#437ed416:0/SimpleConnection@797f97e3 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 47610]
25-11-24.15:35:46.552 [main            ] INFO  Application            - Started Application in 3.415 seconds (JVM running for 3.825)
25-11-24.15:35:46.991 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.15:35:46.992 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.15:35:46.993 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:35:46.993 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
25-11-24.15:35:47.145 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:35:47.157 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:35:47.176 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:35:50.056 [pool-3-thread-3 ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"26021447219","timestamp":1712391046477}
25-11-24.15:35:50.056 [pool-3-thread-4 ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"29510804265","timestamp":1712391047005}
25-11-24.15:35:50.064 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"29510804265","timestamp":1712391047005}
25-11-24.15:35:50.068 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"xiaofuge"},"id":"26021447219","timestamp":1712391046477}
25-11-24.15:36:18.344 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动装配，数据预热开始 activityId:100301
25-11-24.15:36:18.345 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.15:36:18.359 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.15:36:18.425 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动装配，数据预热完成 activityId:100301
25-11-24.15:36:32.367 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:36:32.381 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:36:32.381 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.15:36:32.388 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.15:36:32.389 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.15:36:32.407 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.15:36:32.407 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:36:32.410 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:36:32.410 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【拦截】 userId:xiaofuge strategyId:100006 awardId:106 raffleCount:0 userRaffleCount:0
25-11-24.15:36:32.411 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0001
25-11-24.15:36:32.412 [http-nio-8091-exec-3] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖励 userIdxiaofuge strategyId:100006 awardId:106 ruleValue:101:1,100 
25-11-24.15:36:32.412 [http-nio-8091-exec-3] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:xiaofuge strategyId:100006 awardId:106 awardRuleValue:1,100
25-11-24.15:36:32.412 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_luck_award code:0001
25-11-24.15:36:32.412 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 1,100
25-11-24.15:36:32.565 [http-nio-8091-exec-3] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 101
25-11-24.15:36:32.582 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$cf798ec3.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.15:51:20.758 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:20.861 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:398872165317
25-11-24.15:51:20.869 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:51:20.869 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:51:20.890 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:51:20.891 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:51:20.895 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:51:20.895 [http-nio-8091-exec-6] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【拦截】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:1 userRaffleCount:1
25-11-24.15:51:20.896 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0001
25-11-24.15:51:20.896 [http-nio-8091-exec-6] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖励 userIdxiaofuge strategyId:100006 awardId:108 ruleValue:101:1,100 
25-11-24.15:51:20.896 [http-nio-8091-exec-6] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:xiaofuge strategyId:100006 awardId:108 awardRuleValue:1,100
25-11-24.15:51:20.896 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_luck_award code:0001
25-11-24.15:51:20.896 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 1,100
25-11-24.15:51:20.941 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"28868894920","timestamp":1763995880915}
25-11-24.15:51:20.955 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"28868894920","timestamp":1763995880915}
25-11-24.15:51:22.491 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:22.519 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:618695517426
25-11-24.15:51:22.522 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.15:51:22.522 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.15:51:22.529 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.15:51:22.578 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:51:22.578 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.15:51:22.592 [http-nio-8091-exec-7] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"05414176173","timestamp":1763995882579}
25-11-24.15:51:22.594 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"05414176173","timestamp":1763995882579}
25-11-24.15:51:23.629 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:23.648 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:445728766571
25-11-24.15:51:23.650 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.15:51:23.651 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.15:51:23.664 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.15:51:23.667 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:51:23.667 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.15:51:23.680 [http-nio-8091-exec-8] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"96495666019","timestamp":1763995883670}
25-11-24.15:51:23.682 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":102,"awardTitle":"7等奖","userId":"xiaofuge"},"id":"96495666019","timestamp":1763995883670}
25-11-24.15:51:24.762 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:24.795 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:051780808236
25-11-24.15:51:24.798 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.15:51:24.798 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.15:51:24.801 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.15:51:24.804 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:51:24.804 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.15:51:24.821 [http-nio-8091-exec-9] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"46345323698","timestamp":1763995884808}
25-11-24.15:51:24.822 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"46345323698","timestamp":1763995884808}
25-11-24.15:51:26.042 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:26.066 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:936209722161
25-11-24.15:51:26.070 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.15:51:26.070 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.15:51:26.073 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.15:51:26.075 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:51:26.075 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.15:51:26.086 [http-nio-8091-exec-10] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"72500156740","timestamp":1763995886075}
25-11-24.15:51:26.088 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"72500156740","timestamp":1763995886075}
25-11-24.15:51:27.099 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:24.550 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:098626144759
25-11-24.15:51:24.555 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.15:51:24.556 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.15:51:24.561 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.15:51:24.562 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:51:24.565 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:51:24.566 [http-nio-8091-exec-11] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:6 userRaffleCount:6
25-11-24.15:51:24.566 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.15:51:24.566 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.15:51:24.569 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.15:51:24.569 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.15:51:24.594 [http-nio-8091-exec-11] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"38542748356","timestamp":1763995884574}
25-11-24.15:51:24.600 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":108,"awardTitle":"1等奖","userId":"xiaofuge"},"id":"38542748356","timestamp":1763995884574}
25-11-24.15:51:25.660 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:25.683 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:036247573970
25-11-24.15:51:25.685 [http-nio-8091-exec-12] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.15:51:25.686 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.15:51:25.689 [http-nio-8091-exec-12] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.15:51:25.689 [http-nio-8091-exec-12] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.15:51:25.693 [http-nio-8091-exec-12] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.15:51:25.694 [http-nio-8091-exec-12] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:7 userRaffleCount:7
25-11-24.15:51:25.694 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.15:51:25.694 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.15:51:25.695 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.15:51:25.696 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.15:51:25.710 [http-nio-8091-exec-12] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"80370666660","timestamp":1763995885698}
25-11-24.15:51:25.711 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"80370666660","timestamp":1763995885698}
25-11-24.15:51:27.424 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.15:51:34.251 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.15:51:34.258 [http-nio-8091-exec-13] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.15:51:34.258 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.15:51:34.261 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.15:51:34.261 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.15:51:34.264 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.15:51:34.267 [http-nio-8091-exec-13] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.15:51:34.267 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.15:51:34.272 [http-nio-8091-exec-13] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 102
25-11-24.15:51:34.279 [http-nio-8091-exec-13] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$cf798ec3.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.GeneratedMethodAccessor44.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.15:51:35.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.15:51:40.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.15:51:45.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.15:51:50.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.15:51:52.388 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.15:52:00.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.16:11:04.843 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:11:04.841 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:11:02.985 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:11:03.170 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:11:03.239 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:11:03.240 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:11:09.112 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 68056 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:11:09.114 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:11:10.034 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:11:10.036 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:11:10.070 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
25-11-24.16:11:10.756 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:11:10.763 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:11:10.763 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:11:10.764 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:11:10.833 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:11:10.833 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1680 ms
25-11-24.16:11:11.366 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:11:11.529 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:11:11.540 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:11:12.799 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:11:12.873 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:11:12.889 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:11:12.891 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:11:12.919 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1cd2ff5b:0/SimpleConnection@6e794f53 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 47986]
25-11-24.16:11:12.976 [main            ] INFO  Application            - Started Application in 4.225 seconds (JVM running for 4.697)
25-11-24.16:11:13.045 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:11:13.046 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:11:13.047 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:11:13.048 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:11:13.242 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:11:13.260 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:11:13.283 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:11:23.864 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:23.891 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:23.891 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:23.901 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.16:11:23.901 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.16:11:23.902 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:11:23.917 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:11:23.929 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.16:11:23.929 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:11:23.935 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:11:23.935 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:106 raffleCount:7 userRaffleCount:7
25-11-24.16:11:23.936 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:11:23.936 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:106
25-11-24.16:11:23.961 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:11:23.961 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 106 null
25-11-24.16:11:30.012 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:106
25-11-24.16:11:31.734 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:31.739 [http-nio-8091-exec-4] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:31.740 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:31.744 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.16:11:31.744 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.16:11:31.750 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.16:11:31.754 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:11:31.754 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.16:11:32.876 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:32.881 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:32.881 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:32.886 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.16:11:32.886 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.16:11:32.891 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.16:11:32.894 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:11:32.894 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.16:11:33.873 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:33.877 [http-nio-8091-exec-5] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:33.877 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:33.881 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.16:11:33.881 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.16:11:33.885 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.16:11:33.885 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:11:33.888 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:11:33.888 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:106 raffleCount:7 userRaffleCount:7
25-11-24.16:11:33.888 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:11:33.889 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:106
25-11-24.16:11:33.891 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:11:33.891 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 106 null
25-11-24.16:11:34.760 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:34.765 [http-nio-8091-exec-6] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:34.766 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:34.770 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.16:11:34.770 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.16:11:34.774 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.16:11:34.778 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:11:34.778 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.16:11:40.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.16:11:45.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.16:11:50.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:106
25-11-24.16:11:55.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.16:11:58.111 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:11:58.115 [http-nio-8091-exec-7] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:11:58.116 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:11:58.122 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.16:11:58.122 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.16:11:58.126 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.16:11:58.129 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:11:58.130 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.16:12:05.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.16:12:57.892 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:12:57.894 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:12:58.576 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:12:58.586 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:12:58.610 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:12:58.611 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:13:01.438 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 68775 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:13:01.439 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:13:02.125 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:13:02.132 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:13:02.151 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
25-11-24.16:13:02.630 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:13:02.634 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:13:02.635 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:13:02.635 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:13:02.678 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:13:02.679 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1200 ms
25-11-24.16:13:03.176 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:13:03.292 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:13:03.301 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:13:04.277 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:13:04.340 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:13:04.353 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:13:04.355 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:13:04.376 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#437ed416:0/SimpleConnection@77cd235b [delegate=amqp://admin@127.0.0.1:5672/, localPort= 43782]
25-11-24.16:13:04.430 [main            ] INFO  Application            - Started Application in 3.299 seconds (JVM running for 3.668)
25-11-24.16:13:04.537 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:13:04.537 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:13:04.538 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:04.539 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:13:04.709 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:04.724 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:04.740 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:11.810 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:13:11.835 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:13:11.835 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:13:11.845 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.16:13:11.845 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.16:13:11.845 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:11.860 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:11.871 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.16:13:11.871 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:13:11.889 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:13:11.889 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:106 raffleCount:7 userRaffleCount:7
25-11-24.16:13:11.890 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:13:11.890 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:106
25-11-24.16:13:11.911 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:13:11.911 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 106 null
25-11-24.16:13:15.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:106
25-11-24.16:13:31.272 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:13:31.273 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:13:31.810 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:13:31.838 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:13:31.870 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:13:31.870 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:13:33.914 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 69151 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:13:33.916 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:13:34.691 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:13:34.693 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:13:34.718 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
25-11-24.16:13:35.409 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:13:35.422 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:13:35.424 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:13:35.424 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:13:35.483 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:13:35.483 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1522 ms
25-11-24.16:13:36.066 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:13:36.245 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:13:36.256 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:13:37.473 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:13:37.556 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:13:37.574 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:13:37.576 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:13:37.602 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@7dddfc35 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 43044]
25-11-24.16:13:37.659 [main            ] INFO  Application            - Started Application in 4.227 seconds (JVM running for 4.919)
25-11-24.16:13:38.004 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:13:38.004 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:13:38.004 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:38.006 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:13:38.216 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:38.239 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:38.255 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:43.067 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:13:43.093 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:13:43.093 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:13:43.104 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.16:13:43.105 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.16:13:43.105 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:13:43.121 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:13:43.133 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.16:13:48.926 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:13:48.121 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:13:48.121 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:7 userRaffleCount:7
25-11-24.16:13:48.123 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:13:48.123 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.16:13:48.162 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:13:48.162 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.16:14:12.732 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.16:14:22.748 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:14:22.758 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:14:22.758 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:14:22.766 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.16:14:22.767 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.16:14:22.772 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.16:14:22.777 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:14:22.777 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.16:14:36.998 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.16:15:02.517 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:15:02.521 [http-nio-8091-exec-4] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:15:02.521 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:15:02.525 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.16:15:02.525 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.16:15:02.528 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.16:15:02.531 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:15:02.531 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.16:15:12.162 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.16:15:46.455 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=46s983ms571µs227ns).
25-11-24.16:15:46.456 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=46s984ms89µs184ns).
25-11-24.16:15:46.467 [scheduling-1    ] ERROR UpdateActivitySkuStockJob - 定时任务，更新活动sku库存失败
org.springframework.dao.QueryTimeoutException: Redis server response timeout (3000 ms) occured after 1 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0x795eb5a6, L:/127.0.0.1:35130 - R:127.0.0.1/127.0.0.1:16379]; nested exception is org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (3000 ms) occured after 1 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0x795eb5a6, L:/127.0.0.1:35130 - R:127.0.0.1/127.0.0.1:16379]
	at org.redisson.spring.data.connection.RedissonExceptionConverter.convert(RedissonExceptionConverter.java:48)
	at org.redisson.spring.data.connection.RedissonExceptionConverter.convert(RedissonExceptionConverter.java:35)
	at org.springframework.data.redis.PassThroughExceptionTranslationStrategy.translate(PassThroughExceptionTranslationStrategy.java:44)
	at org.redisson.spring.data.connection.RedissonConnectionFactory.translateExceptionIfPossible(RedissonConnectionFactory.java:91)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$d980bc18.takeQueueValue(<generated>)
	at org.example.domain.activity.service.quota.RaffleActivityAccountQuotaService.takeQueueValue(RaffleActivityAccountQuotaService.java:70)
	at org.example.trigger.job.UpdateActivitySkuStockJob.exec(UpdateActivitySkuStockJob.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.redisson.client.RedisResponseTimeoutException: Redis server response timeout (3000 ms) occured after 1 retry attempts, is non-idempotent command: true Check connection with Redis node: 127.0.0.1/127.0.0.1:16379 for TCP packet drops or bandwidth limits.  Try to increase nettyThreads and/or timeout settings. Command: (LPOP), params: [activity_sku_count_query_key], channel: [id: 0x795eb5a6, L:/127.0.0.1:35130 - R:127.0.0.1/127.0.0.1:16379]
	at org.redisson.command.RedisExecutor.lambda$scheduleResponseTimeout$9(RedisExecutor.java:407)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.run(HashedWheelTimer.java:715)
	at io.netty.util.concurrent.ImmediateExecutor.execute(ImmediateExecutor.java:34)
	at io.netty.util.HashedWheelTimer$HashedWheelTimeout.expire(HashedWheelTimer.java:703)
	at io.netty.util.HashedWheelTimer$HashedWheelBucket.expireTimeouts(HashedWheelTimer.java:790)
	at io.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:503)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
25-11-24.16:15:49.346 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:15:49.352 [http-nio-8091-exec-5] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:15:49.352 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:15:49.356 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.16:15:49.356 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.16:15:49.360 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.16:15:49.363 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:15:49.363 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.16:15:55.391 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.16:16:04.245 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:16:04.251 [http-nio-8091-exec-6] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:16:04.251 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:16:04.255 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.16:16:04.256 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.16:16:04.261 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.16:16:04.264 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:16:04.264 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.16:16:07.357 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.16:16:10.067 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:16:10.071 [http-nio-8091-exec-7] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:16:10.071 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:16:10.074 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.16:16:10.075 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.16:16:10.078 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.16:16:10.080 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:16:10.080 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.16:16:11.518 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:16:11.523 [http-nio-8091-exec-8] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:16:11.523 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:16:11.527 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 106
25-11-24.16:16:11.527 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 106 rule_default
25-11-24.16:16:11.531 [http-nio-8091-exec-8] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:106 ruleValue:1
25-11-24.16:16:11.531 [http-nio-8091-exec-8] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:16:11.534 [http-nio-8091-exec-8] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:16:11.534 [http-nio-8091-exec-8] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:106 raffleCount:7 userRaffleCount:7
25-11-24.16:16:11.534 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:16:11.534 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:106
25-11-24.16:16:11.536 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:16:11.536 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 106 null
25-11-24.16:16:13.451 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:16:13.452 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:16:13.476 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:16:13.476 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:16:13.494 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:16:13.495 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:16:15.681 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 69961 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:16:15.684 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:16:16.599 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:16:16.602 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:16:16.625 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.16:16:17.206 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:16:17.211 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:16:17.212 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:16:17.212 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:16:17.265 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:16:17.265 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1465 ms
25-11-24.16:16:17.885 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:16:18.049 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:16:18.059 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:16:19.265 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:16:19.347 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:16:19.364 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:16:19.366 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:16:19.393 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#133aacbe:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 47948]
25-11-24.16:16:19.450 [main            ] INFO  Application            - Started Application in 4.287 seconds (JVM running for 5.073)
25-11-24.16:16:19.655 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:16:19.655 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:16:19.656 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:16:19.657 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:16:19.848 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:16:19.865 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:16:19.884 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:16:20.059 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.16:16:20.061 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:16:20.083 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:16:33.164 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:16:33.193 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:16:33.193 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:16:33.206 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.16:16:33.207 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.16:16:33.221 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.16:16:33.251 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:16:33.251 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.16:16:32.406 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:106
25-11-24.16:16:42.056 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.16:17:27.049 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s96ms695µs435ns).
25-11-24.16:17:27.049 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s332ms180µs520ns).
25-11-24.16:17:27.049 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m12s295ms186µs221ns).
25-11-24.16:17:27.079 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:17:27.081 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:17:28.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:17:28.058 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:17:25.370 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:17:25.371 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:17:28.825 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 70534 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:17:28.827 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:17:29.600 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:17:29.602 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:17:29.632 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.16:17:30.202 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:17:30.207 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:17:30.208 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:17:30.208 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:17:30.271 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:17:30.271 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1403 ms
25-11-24.16:17:30.860 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:17:31.028 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:17:31.038 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:17:32.236 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:17:32.320 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:17:32.337 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:17:32.340 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:17:32.366 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 51074]
25-11-24.16:17:32.421 [main            ] INFO  Application            - Started Application in 4.088 seconds (JVM running for 4.664)
25-11-24.16:17:32.631 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:17:32.632 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:17:32.633 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:17:32.634 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:17:32.828 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:17:32.844 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:17:32.865 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:17:36.863 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:17:36.891 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:17:36.891 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:17:36.901 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.16:17:36.902 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.16:17:36.902 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:17:36.919 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:17:36.933 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.16:17:36.933 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:17:36.938 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:17:36.938 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:7 userRaffleCount:7
25-11-24.16:17:36.939 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:17:36.939 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.16:17:36.967 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:17:36.967 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.16:17:40.506 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.16:19:12.322 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m40s976ms90µs189ns).
25-11-24.16:19:12.322 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m47s363ms296µs191ns).
25-11-24.16:19:12.324 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m47s326ms389µs711ns).
25-11-24.16:19:12.345 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:19:12.346 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:19:13.330 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:19:13.331 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:19:13.371 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:19:13.371 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:19:16.460 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 71168 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:19:16.463 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:19:17.282 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:19:17.283 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:19:17.308 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.16:19:17.192 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:19:17.198 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:19:17.198 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:19:17.198 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:19:17.254 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:19:17.254 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 746 ms
25-11-24.16:19:17.883 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:19:18.069 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:19:18.079 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:19:19.310 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:19:19.394 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:19:19.411 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:19:19.413 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:19:19.438 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 55152]
25-11-24.16:19:19.494 [main            ] INFO  Application            - Started Application in 4.207 seconds (JVM running for 4.708)
25-11-24.16:19:19.551 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:19:19.551 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:19:19.551 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:19:19.553 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:19:19.847 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:19:19.862 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:19:19.878 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:19:25.266 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:19:25.293 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:19:25.293 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:19:25.303 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.16:19:25.304 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.16:19:25.305 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:19:25.319 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:19:25.330 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.16:19:25.357 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:19:25.358 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.16:19:30.422 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.16:22:08.312 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m53s435ms872µs837ns).
25-11-24.16:22:08.314 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m1s61ms925µs238ns).
25-11-24.16:22:08.309 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m1s31ms860µs143ns).
25-11-24.16:22:08.360 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:22:08.375 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:22:08.375 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:22:08.385 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.16:22:08.386 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.16:22:08.398 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.16:22:08.406 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:22:08.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:22:08.408 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:22:08.408 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.16:22:09.300 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:22:09.300 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:22:09.332 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:22:09.333 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:22:11.875 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 71954 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:22:11.878 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:22:12.911 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:22:12.915 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:22:12.967 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
25-11-24.16:22:13.653 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:22:13.659 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:22:13.660 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:22:13.660 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:22:13.721 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:22:13.721 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1764 ms
25-11-24.16:22:14.571 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:22:14.756 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:22:14.768 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:22:16.226 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:22:16.325 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:22:16.345 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:22:16.347 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:22:16.379 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f193335:0/SimpleConnection@1bb172dd [delegate=amqp://admin@127.0.0.1:5672/, localPort= 33820]
25-11-24.16:22:16.445 [main            ] INFO  Application            - Started Application in 5.088 seconds (JVM running for 5.754)
25-11-24.16:22:16.975 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:22:16.976 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:22:16.977 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:22:16.978 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:22:17.197 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:22:17.216 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:22:17.235 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:22:20.218 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:22:20.247 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:22:20.247 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:22:20.260 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.16:22:20.261 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.16:22:20.262 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:22:20.287 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:22:20.305 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.16:22:20.305 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:22:20.311 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:22:20.312 [http-nio-8091-exec-1] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:7 userRaffleCount:7
25-11-24.16:22:20.312 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:22:20.313 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.16:22:20.340 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:22:20.340 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.16:22:30.164 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
25-11-24.16:30:23.521 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m49s893ms894µs750ns).
25-11-24.16:30:23.473 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m49s824ms901µs551ns).
25-11-24.16:30:57.033 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 73776 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:30:57.035 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:30:58.491 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:30:58.496 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:30:58.553 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
25-11-24.16:31:00.561 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:31:00.586 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:31:00.587 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:31:00.587 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:31:00.775 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:31:00.776 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3625 ms
25-11-24.16:31:04.623 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:31:05.235 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:31:05.306 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:31:09.199 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:31:09.322 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:31:09.353 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:31:09.357 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:31:09.417 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#418f0534:0/SimpleConnection@6550ce46 [delegate=amqp://admin@127.0.0.1:5672/, localPort= 46948]
25-11-24.16:31:09.523 [main            ] INFO  Application            - Started Application in 13.189 seconds (JVM running for 14.348)
25-11-24.16:31:09.699 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:31:09.699 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:31:09.700 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:31:09.703 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 3 ms
25-11-24.16:31:10.157 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:31:10.258 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.16:31:10.261 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:31:10.375 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:31:10.375 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:31:10.380 [scheduling-1    ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:31:27.933 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:31:28.054 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:31:28.054 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:31:28.089 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 108
25-11-24.16:31:28.091 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 108 rule_default
25-11-24.16:31:28.148 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:108 ruleValue:2
25-11-24.16:31:28.149 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:31:28.186 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:31:28.187 [http-nio-8091-exec-2] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:108 raffleCount:7 userRaffleCount:7
25-11-24.16:31:28.188 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_lock code:0000
25-11-24.16:31:28.189 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:108
25-11-24.16:31:28.302 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:rule_stock code:0001
25-11-24.16:31:28.302 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 108 null
25-11-24.16:31:28.762 [http-nio-8091-exec-2] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 108
25-11-24.16:31:28.793 [http-nio-8091-exec-2] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:102)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$5e87c0a4.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:87)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.16:31:35.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-11-24.16:31:55.424 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:31:55.433 [http-nio-8091-exec-3] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:31:55.433 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:31:55.443 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 105
25-11-24.16:31:55.443 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 105 rule_default
25-11-24.16:31:55.451 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:105
25-11-24.16:31:55.463 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:31:55.463 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 105 null
25-11-24.16:55:07.853 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=25m45s459ms344µs107ns).
25-11-24.16:55:07.853 [http-nio-8091-exec-3] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 105
25-11-24.16:55:07.853 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=25m45s465ms88µs419ns).
25-11-24.16:55:07.861 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=25m45s463ms426µs435ns).
25-11-24.16:55:08.179 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-11-24.16:55:08.259 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:102)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$5e87c0a4.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:87)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.16:55:08.486 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:55:08.487 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:55:08.487 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-11-24.16:55:08.488 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-11-24.16:55:08.799 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:55:08.802 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-11-24.16:55:30.571 [main            ] INFO  Application            - Starting Application using Java 1.8.0_462 on Pluto with PID 78941 (/home/pluto/Project/BigMarket/BigMarket-app/target/classes started by pluto in /home/pluto/Project/BigMarket)
25-11-24.16:55:30.575 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-11-24.16:55:34.793 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-11-24.16:55:34.803 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-11-24.16:55:34.980 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 57 ms. Found 0 Redis repository interfaces.
25-11-24.16:55:38.797 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-11-24.16:55:38.834 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-11-24.16:55:38.835 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-11-24.16:55:38.836 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-11-24.16:55:39.156 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-11-24.16:55:39.157 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 8321 ms
25-11-24.16:55:41.872 [main            ] INFO  Version                - Redisson 3.23.4
25-11-24.16:55:42.641 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:55:42.725 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
25-11-24.16:55:46.612 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-11-24.16:55:46.959 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-11-24.16:55:47.025 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-11-24.16:55:47.032 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-11-24.16:55:47.242 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7e7740a5:0/SimpleConnection@3b9c9b8b [delegate=amqp://admin@127.0.0.1:5672/, localPort= 38420]
25-11-24.16:55:47.443 [main            ] INFO  Application            - Started Application in 21.014 seconds (JVM running for 22.741)
25-11-24.16:55:48.062 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:55:48.092 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-11-24.16:55:48.093 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-11-24.16:55:48.095 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
25-11-24.16:55:48.918 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:55:48.977 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:55:49.020 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:55:59.409 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:55:59.528 [http-nio-8091-exec-1] INFO  AbstractRaffleActivityPartake - 创建参与活动订单【已存在未消费】 userId:xiaofuge activityId:100301 userRaffleOrderEntity
25-11-24.16:55:59.529 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:313091076458
25-11-24.16:55:59.558 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 102
25-11-24.16:55:59.559 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 102 rule_default
25-11-24.16:55:59.560 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-11-24.16:55:59.622 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-11-24.16:55:59.661 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:102
25-11-24.16:55:59.779 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:55:59.780 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 102 null
25-11-24.16:56:00.355 [http-nio-8091-exec-1] ERROR AwardRepository        - 写入中奖记录，唯一索引冲突 userId: xiaofuge activityId: 100301 awardId: 102
25-11-24.16:56:00.397 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:xiaofuge activityId:100301 code:{} info:{}
org.example.types.exception.AppException: null
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:96)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.example.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:79)
	at org.example.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$8373593d.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$ff19b246.saveUserAwardRecord(<generated>)
	at org.example.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:54)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:103)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
### The error may exist in file [/home/pluto/Project/BigMarket/BigMarket-app/target/classes/mybatis/mapper/user_award_record_mapper.xml]
### The error may involve org.example.infrastructure.persistent.dao.IUserAwardRecordDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_award_record_001(             user_id, activity_id, strategy_id, order_id, award_id, award_title, award_time, award_state, create_time, update_time         ) values (                      ?,?,?,?,?,?,?,?,now(),now()                  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
; Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy135.insert(Unknown Source)
	at org.example.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:82)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry '313091076458' for key 'user_award_record_001.uq_order_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy181.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
25-11-24.16:56:05.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:102
25-11-24.16:56:23.468 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:56:23.548 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:828178945959
25-11-24.16:56:23.555 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 101
25-11-24.16:56:23.555 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 101 rule_default
25-11-24.16:56:23.560 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:101
25-11-24.16:56:23.565 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:56:23.565 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 101 null
25-11-24.16:56:23.607 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"93246906679","timestamp":1763999783566}
25-11-24.16:56:23.646 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":101,"awardTitle":"随机积分","userId":"xiaofuge"},"id":"93246906679","timestamp":1763999783566}
25-11-24.16:56:25.406 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:56:25.452 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:314292047225
25-11-24.16:56:25.459 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.16:56:25.460 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.16:56:25.465 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.16:56:25.466 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:56:25.480 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:56:25.480 [http-nio-8091-exec-3] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:9 userRaffleCount:9
25-11-24.16:56:25.481 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:56:25.481 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.16:56:25.484 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:56:25.484 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.16:56:25.514 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"85548618687","timestamp":1763999785487}
25-11-24.16:56:25.517 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"85548618687","timestamp":1763999785487}
25-11-24.16:56:27.138 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:56:27.185 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:496791425596
25-11-24.16:56:27.191 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 107
25-11-24.16:56:27.192 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 107 rule_default
25-11-24.16:56:27.202 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:xiaofuge strategyId:100006 awardId:107 ruleValue:1
25-11-24.16:56:27.203 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 你咋没输出1?
25-11-24.16:56:27.209 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 你咋没输出2?
25-11-24.16:56:27.209 [http-nio-8091-exec-5] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:xiaofuge strategyId:100006 awardId:107 raffleCount:10 userRaffleCount:10
25-11-24.16:56:27.209 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-11-24.16:56:27.209 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:107
25-11-24.16:56:27.214 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-11-24.16:56:27.215 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 107 null
25-11-24.16:56:27.243 [http-nio-8091-exec-5] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"98246950505","timestamp":1763999787216}
25-11-24.16:56:27.247 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":107,"awardTitle":"2等奖","userId":"xiaofuge"},"id":"98246950505","timestamp":1763999787216}
25-11-24.16:56:28.895 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:56:28.945 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:020244204501
25-11-24.16:56:28.950 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 104
25-11-24.16:56:28.951 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 104 rule_default
25-11-24.16:56:28.957 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:104
25-11-24.16:56:28.963 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:56:28.964 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 104 null
25-11-24.16:56:28.988 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"53238288055","timestamp":1763999788965}
25-11-24.16:56:28.990 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":104,"awardTitle":"5等奖","userId":"xiaofuge"},"id":"53238288055","timestamp":1763999788965}
25-11-24.16:56:30.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:101
25-11-24.16:56:30.693 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:xiaofuge activityId:100301
25-11-24.16:56:30.793 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖， 创建订单 userId:xiaofuge activityId:100301 orderId:024102257818
25-11-24.16:56:30.800 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: xiaofuge strategyId: 100006 ruleModel: rule_default awardId: 103
25-11-24.16:56:30.801 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xiaofuge 100006 103 rule_default
25-11-24.16:56:30.808 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xiaofuge strategyId:100006 awardId:103
25-11-24.16:56:30.815 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-11-24.16:56:30.816 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xiaofuge 100006 103 null
25-11-24.16:56:30.850 [http-nio-8091-exec-7] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"06506984535","timestamp":1763999790817}
25-11-24.16:56:30.852 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"6等奖","userId":"xiaofuge"},"id":"06506984535","timestamp":1763999790817}
25-11-24.16:56:35.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.16:56:40.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:107
25-11-24.16:56:45.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-11-24.16:56:50.014 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:103
